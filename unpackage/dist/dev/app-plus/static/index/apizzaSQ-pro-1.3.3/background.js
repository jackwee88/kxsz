"use strict";var AjaxXhr;function removeDefaultHeaders(e){var a=[];for(var r of e)["origin","user-agent","accept-language","referer"].includes(r.name.toLowerCase())||a.push(r);return a.push({name:"User-Agent",value:"apizza-extension"}),a}chrome.browserAction.onClicked.addListener(function(e){window.open("https://apizza.net/?f=chromeapp")}),chrome.runtime.onMessage.addListener(function(e,a,r){if("stop"!==e){var t,s={},n={async:!0,crossDomain:!0,method:e.method.toUpperCase(),url:e.url,timeout:0},o=function(a){for(var r in a.requestHeaders=removeDefaultHeaders(a.requestHeaders),e.headers)a.requestHeaders.push({name:r,value:e.headers[r]});return{requestHeaders:a.requestHeaders}};if(null!=e.contentType&&(n.contentType=e.contentType),null!=e.processData&&(n.processData=e.processData),null!=e.headers&&(n.headers=e.headers),null!=e.data&&e.isPost)if("form-data"===e.bodyType){for(var d=new FormData,u=0;u<e.data.length;u++){var l=e.data[u],i=l.key,p=l.value;if("FILE"===l.rtype){var c=l.filename?l.filename:"undefined";p=dataURLtoBlob(p),d.append(i,p,c)}else d.append(i,p)}n.data=d}else if("x-www-form-urlencoded"===e.bodyType){var f={};for(u=0;u<e.data.length;u++)i=e.data[u].key,p=e.data[u].value,f[i]=p;n.data=f}else n.data=e.data;n.beforeSend=function(){t=(new Date).getTime();try{chrome.webRequest.onBeforeSendHeaders.addListener(o,{urls:[e.url]},["requestHeaders","blocking","extraHeaders"])}catch(a){chrome.webRequest.onBeforeSendHeaders.addListener(o,{urls:[e.url]},["requestHeaders","blocking"])}},n.complete=function(r){s.readyState=r.readyState,s.status=r.status,s.headers=r.getAllResponseHeaders(),s.headerStatus=r.status+" "+r.statusText,s.contentType=r.getResponseHeader("Content-Type"),s.responseText=r.responseText,s.statusText=r.statusText,s.runtime=(new Date).getTime()-t,s.apiID=e.apiID,s.flowApiId=e.id,s.url=e.url,chrome.tabs.sendMessage(a.tab.id,s),chrome.webRequest.onBeforeSendHeaders.removeListener(o,{urls:[e.url]},["requestHeaders","blocking"]),AjaxXhr=null},AjaxXhr=$.ajax(n)}else void 0===AjaxXhr||null==AjaxXhr||(AjaxXhr.abort(),AjaxXhr=null)});