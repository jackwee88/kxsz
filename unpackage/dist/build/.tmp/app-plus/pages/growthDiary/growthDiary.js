(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/growthDiary/growthDiary"],{"07df":function(t,e,a){},"164a":function(t,e,a){"use strict";var i,s=function(){var t=this,e=t.$createElement;t._self._c},n=[];a.d(e,"b",function(){return s}),a.d(e,"c",function(){return n}),a.d(e,"a",function(){return i})},"1d5d":function(t,e,a){"use strict";a.r(e);var i=a("2da0"),s=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);e["default"]=s.a},"2da0":function(t,e,a){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a("60db");function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=a("ec2b"),o={data:function(){return{canvas:{},p_id:"",user:{},name:"梁雨淇",uid:"",jionNum:"320",pieceNum:"225",modulecont:"超棒的一门课，已经完成前两门课，很系统，思路清晰。配套的练习很有意思.超棒的一门课",geqiancont:"#开心日记#开心日记！",daka:[],is_share:"",index_:"",is_ok:"",type:"",background:"",code:"",avatar:"",isCan:!1,nickname:"",d:"",y:"",title:"",date:"",where:"",word:"",back:0,is_give:"",thumbs_times:"",up:"",is_give_:"",to_details:!1,preview:!1,item:"",indeNum:""}},components:{},props:{},onLoad:function(e){var a=this;e.is_share&&this.setData({is_share:1}),e.uid&&(this.setData({uid:e.uid,daka:[],p_id:e.pid,index_:e.index,type:e.type}),t("log","nihao"+this.uid," at pages\\growthDiary\\growthDiary.vue:279")),this.getData(),this.getSign(),this.getModule();var i=this;if(e.dy_id){r.ajaxs("study/bill",{dy_id:e.dy_id},function(t){i.setData({nickname:t.data.nickname,d:t.data.d,y:t.data.y,title:t.data.title,date:t.data.date,where:t.data.where,word:t.data.word}),wx.downloadFile({url:t.data.avatar,success:function(t){i.setData({avatar:t.tempFilePath}),i.beginCanvas()},fail:function(t){}});var e=t.data.code,s=wx.getFileSystemManager(),n=wx.env.USER_DATA_PATH+"/eeeeeeeeee.jpg",r=e.replace(/^data:image\/\w+;base64,/,"");s.writeFile({filePath:n,data:r,encoding:"base64",success:function(t){a.setData({code:n})},fail:function(t){}}),wx.downloadFile({url:t.data.background,success:function(t){i.setData({background:t.tempFilePath}),i.beginCanvas()},fail:function(t){}})});var s=getCurrentPages(),n=s[s.length-2];n.setData({back:1})}},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(t){var e=this;if("button"===t.from){if(t.target.dataset.hb=1)return this.setData({to_details:!1}),{title:"开心书写",path:"/pages/myPublished/myPublished?dy_id="+this.dy_id+"&is_share=1",success:function(t){}};var a=t.target.dataset.nickname,i=a+"的打卡日记",s=t.target.dataset.image,n=t.target.dataset.video;if(s)var r=s;else if(n)r=n+"?spm=a2c4g.11186623.2.1.yjOb8V&x-oss-process=video/snapshot,t_0000,f_jpg,w_800,h_600,m_fast";return{title:i,path:"/pages/growthDiary/growthDiary?uid="+e.uid+"&is_share=1",imageUrl:r,success:function(t){}}}},methods:{setData:function(t){for(var e in t){var a=t[e];this[e]=a}},getSign:function(){var t=this;r.ajaxs("index/getSystem",{type:6},function(e){t.setData({geqiancont:e.data})})},getModule:function(){var t=this;r.ajaxs("index/getSystem",{type:7},function(e){t.setData({modulecont:e.data})})},getData:function(){var e=this;e.setData({daka:[]});var a={uid:e.uid};(0,s.ajax)({url:"/index/UserCenter",data:a,success:function(a){for(var i=a.data.data.list,s={method:"pause"},n=0;n<i.length;n++)i[n].action=s,i[n].poster=i[n].picture_idss[0],i[n].name=i[n].nickname+"的音频";e.setData({user:a.data.data.user,daka:i}),t("log"," at pages\\growthDiary\\growthDiary.vue:495")}})},praise:function(e){var a=this,i=this,s=e.currentTarget.dataset.index,o=e.currentTarget.dataset.dy_id,d=i.index_;t("log",s+"index"," at pages\\growthDiary\\growthDiary.vue:504"),r.ajaxs("study/praiseStudy",{dy_id:o},function(e){var n=i.daka;1==e.data.is_ok?(t("log","点赞成功"," at pages\\growthDiary\\growthDiary.vue:516"),a.daka[s].is_give=!n[s].is_give,a.daka[s].thumbs_times=n[s].thumbs_times+1,a.is_ok="y"):(t("log","取消点赞"," at pages\\growthDiary\\growthDiary.vue:521"),a.daka[s].is_give=!n[s].is_give,a.daka[s].thumbs_times=n[s].thumbs_times-1,a.is_ok="n")}),setTimeout(function(){var t=i.daka;if("y"==i.is_ok){if(o==i.p_id){var e,a=getCurrentPages(),r=a[a.length-2];if(1==i.type)var u="daily["+d+"].thumbs_times",c="daily["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;else if(3==i.type||4==i.type)u="daka["+d+"].thumbs_times",c="daka["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;else if(2==i.type)u="studylist["+d+"].thumbs_times",c="studylist["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;r.setData((e={},n(e,u,l),n(e,c,f),e))}}else if(o==i.p_id){var g;a=getCurrentPages(),r=a[a.length-2];if(1==i.type)u="daily["+d+"].thumbs_times",c="daily["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;else if(3==i.type||4==i.type)u="daka["+d+"].thumbs_times",c="daka["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;else if(2==i.type)u="studylist["+d+"].thumbs_times",c="studylist["+d+"].is_give",l=t[s].thumbs_times,f=t[s].is_give;r.setData((g={},n(g,u,l),n(g,c,f),g))}},1e3)},previewImg:function(t){var e=t.currentTarget.dataset.src,a=t.currentTarget.dataset.effect_pic;wx.previewImage({currrent:e,urls:a})},details:function(t){var e={dy_id:t.currentTarget.dataset.dy_id,index:t.currentTarget.dataset.index,browse_times:t.currentTarget.dataset.browse_times,comment_count:t.currentTarget.dataset.comment_count,thumbs_times:t.currentTarget.dataset.thumbs_times,type:4};i.navigateTo({url:"../myPublished/myPublished?pulishedDetail="+encodeURIComponent(JSON.stringify(e))})},playVideo:function(t){this.setData({preview:!1});var e=t.currentTarget.dataset.src;wx.navigateTo({url:"../video/video?src="+e})},goindex:function(){var t=this;getApp().globalData.infoModel(),t.onShow()},playorpause:function(t){var e=this,a=t.target.dataset.index,i="daka["+a+"].action",s={method:"play"},r={method:"pause"};if("pause"==e.daka[a].action.method){e.setData(n({},i,s));for(var o=0;o<e.daka.length;o++)if(a!=o){var d="daka["+o+"].action";e.setData(n({},d,r))}}else e.setData(n({},i,r))},beginCanvas:function(){var t=this;if(t.background&&t.avatar&&t.code){var e=wx.createCanvasContext("customCanvas");e.drawImage(t.background,0,0,320,480),e.setFillStyle("white"),e.setFontSize(32),e.fillText(t.d,25,50),e.setFontSize(16),e.fillText(t.y,25,80),e.setFontSize(16);for(var a=[],i=0;i<t.word.length;i++){var s=Math.ceil((i+1)/15);a[s-1]?a[s-1]+=t.word[i]:a[s-1]=t.word[i]}for(var n=0;n<a.length;n++)e.fillText(a[n],25,120+20*n);t.drawRoundedRect(e,25,250,280,110,8,!0,!1),e.fillText(t.title,25,175),e.drawImage(t.avatar,40,260,50,50),e.setFillStyle("black"),e.setFontSize(16),e.fillText(t.nickname,100,275),e.setFillStyle("gray"),e.setFontSize(12),e.fillText(t.where,100,300),e.moveTo(40,315),e.lineTo(280,317),e.ineWidth=1,e.strokeStyle="#f5f5f5",e.stroke(),e.setFontSize(16),e.fillText("坚持打卡天数",50,340),e.setFillStyle("black"),e.setFontSize(12);var r=t.date+"天";e.fillText(r,250,340),e.setFillStyle("white"),t.drawRoundedRect(e,25,400,280,55,8,!0,!1),e.drawImage("/img/index/logo.png",35,408,100,40),e.drawImage(t.code,240,408,40,40),e.draw(),t.setData({isCan:!0})}},save:function(){wx.canvasToTempFilePath({canvasId:"customCanvas",success:function(t){wx.authorize({scope:"scope.writePhotosAlbum",success:function(){wx.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){wx.showToast({title:"图片保存成功",mask:!0});var t=Date.parse(new Date)/1e3;String(t),String(Math.floor(50*Math.random()))}})}})}},this)},closeCan:function(t){this.setData({isCan:!1})},shares:function(){wx.navigateTo({url:"/pages/myPublished/myPublished?dy_id="+this.dy_id})},drawRoundedRect:function(t,e,a,i,s,n,r,o){t.save(),t.beginPath(),t.moveTo(e+n,a),t.arcTo(e+i,a,e+i,a+n,n),t.arcTo(e+i,a+s,e+i-n,a+s,n),t.arcTo(e,a+s,e,a+s-n,n),t.arcTo(e,a,e+n,a,n),r&&t.fill(),o&&t.stroke(),t.restore()},toTop:function(t){var e=this;e.pageScrollTo({scrollTop:0,duration:0})}}};e.default=o}).call(this,a("0de9")["default"],a("6e42")["default"])},4381:function(t,e,a){"use strict";(function(t){a("f9cd"),a("921b");i(a("66fd"));var e=i(a("6e87"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},"6e87":function(t,e,a){"use strict";a.r(e);var i=a("164a"),s=a("1d5d");for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);a("f699");var r,o=a("f0c5"),d=Object(o["a"])(s["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);e["default"]=d.exports},f699:function(t,e,a){"use strict";var i=a("07df"),s=a.n(i);s.a}},[["4381","common/runtime","common/vendor"]]]);