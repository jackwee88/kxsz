(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/growthDiary/growthDiary"],{"07df":function(t,e,a){},"1d5d":function(t,e,a){"use strict";a.r(e);var i=a("2da0"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e["default"]=n.a},"2da0":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("60db");function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var s=a("ec2b"),r={data:function(){return{canvas:{},p_id:"",user:{},name:"梁雨淇",uid:"",jionNum:"320",pieceNum:"225",modulecont:"",geqiancont:"#开心日记#开心日记！",daka:[],is_share:"",index_:"",is_ok:"",type:"",background:"",code:"",avatar:"",isCan:!1,nickname:"",d:"",y:"",title:"",date:"",where:"",word:"",back:0,is_give:"",thumbs_times:"",up:"",is_give_:"",to_details:!1,preview:!1,item:"",indeNum:""}},components:{},props:{},onLoad:function(t){var e=this;t.is_share&&this.setData({is_share:1}),t.uid&&this.setData({uid:t.uid,daka:[],p_id:t.pid,index_:t.index,type:t.type}),this.getData(),this.getSign(),this.getModule();var a=this;if(t.dy_id){s.ajaxs("study/bill",{dy_id:t.dy_id},function(t){a.setData({nickname:t.data.nickname,d:t.data.d,y:t.data.y,title:t.data.title,date:t.data.date,where:t.data.where,word:t.data.word}),wx.downloadFile({url:t.data.avatar,success:function(t){a.setData({avatar:t.tempFilePath}),a.beginCanvas()},fail:function(t){}});var i=t.data.code,n=wx.getFileSystemManager(),s=wx.env.USER_DATA_PATH+"/eeeeeeeeee.jpg",r=i.replace(/^data:image\/\w+;base64,/,"");n.writeFile({filePath:s,data:r,encoding:"base64",success:function(t){e.setData({code:s})},fail:function(t){}}),wx.downloadFile({url:t.data.background,success:function(t){a.setData({background:t.tempFilePath}),a.beginCanvas()},fail:function(t){}})});var i=getCurrentPages(),n=i[i.length-2];n.setData({back:1})}},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(t){var e=this;if("button"===t.from){if(t.target.dataset.hb=1)return this.setData({to_details:!1}),{title:"开心书写",path:"/pages/myPublished/myPublished?dy_id="+this.dy_id+"&is_share=1",success:function(t){}};var a=t.target.dataset.nickname,i=a+"的打卡日记",n=t.target.dataset.image,s=t.target.dataset.video;if(n)var r=n;else if(s)r=s+"?spm=a2c4g.11186623.2.1.yjOb8V&x-oss-process=video/snapshot,t_0000,f_jpg,w_800,h_600,m_fast";return{title:i,path:"/pages/growthDiary/growthDiary?uid="+e.uid+"&is_share=1",imageUrl:r,success:function(t){}}}},methods:{setData:function(t){for(var e in t){var a=t[e];this[e]=a}},getSign:function(){var t=this;s.ajaxs("index/getSystem",{type:6},function(e){t.setData({geqiancont:e.data})})},getModule:function(){var t=this;s.ajaxs("index/getSystem",{type:7},function(e){t.setData({modulecont:e.data})})},getData:function(){var t=this;t.setData({daka:[]});var e={uid:t.uid};(0,i.ajax)({url:"/index/UserCenter",data:e,success:function(e){for(var a=e.data.data.list,i={method:"pause"},n=0;n<a.length;n++)a[n].action=i,a[n].poster=a[n].picture_idss[0],a[n].name=a[n].nickname+"的音频";t.setData({user:e.data.data.user,daka:a})}})},praise:function(t){var e=this,a=this,i=t.currentTarget.dataset.index,n=t.currentTarget.dataset.dy_id;a.index_;s.ajaxs("study/praiseStudy",{dy_id:n},function(t){var n=a.daka;1==t.data.is_ok?(e.daka[i].is_give=!n[i].is_give,e.daka[i].thumbs_times=n[i].thumbs_times+1,e.is_ok="y"):(e.daka[i].is_give=!n[i].is_give,e.daka[i].thumbs_times=n[i].thumbs_times-1,e.is_ok="n")}),setTimeout(function(){a.daka;if("y"==a.is_ok){if(n==a.p_id){var t=getCurrentPages();t[t.length-2];1==a.type||3==a.type||4==a.type||a.type}}else if(n==a.p_id){t=getCurrentPages(),t[t.length-2];1==a.type||3==a.type||4==a.type||a.type}},1e3)},previewImg:function(t){var e=t.currentTarget.dataset.src,a=t.currentTarget.dataset.effect_pic,i=a.split(",");wx.previewImage({current:e,urls:i})},details:function(e){var a={dy_id:e.currentTarget.dataset.dy_id,index:e.currentTarget.dataset.index,browse_times:e.currentTarget.dataset.browse_times,comment_count:e.currentTarget.dataset.comment_count,thumbs_times:e.currentTarget.dataset.thumbs_times,type:4};t.navigateTo({url:"../myPublished/myPublished?pulishedDetail="+encodeURIComponent(JSON.stringify(a))})},playVideo:function(t){this.setData({preview:!1});var e=t.currentTarget.dataset.src;wx.navigateTo({url:"../video/video?src="+e})},goindex:function(){var t=this;getApp().globalData.infoModel(),t.onShow()},playorpause:function(t){var e=this,a=t.target.dataset.index,i="daka["+a+"].action",s={method:"play"},r={method:"pause"};if("pause"==e.daka[a].action.method){e.setData(n({},i,s));for(var o=0;o<e.daka.length;o++)if(a!=o){var d="daka["+o+"].action";e.setData(n({},d,r))}}else e.setData(n({},i,r))},beginCanvas:function(){var t=this;if(t.background&&t.avatar&&t.code){var e=wx.createCanvasContext("customCanvas");e.drawImage(t.background,0,0,320,480),e.setFillStyle("white"),e.setFontSize(32),e.fillText(t.d,25,50),e.setFontSize(16),e.fillText(t.y,25,80),e.setFontSize(16);for(var a=[],i=0;i<t.word.length;i++){var n=Math.ceil((i+1)/15);a[n-1]?a[n-1]+=t.word[i]:a[n-1]=t.word[i]}for(var s=0;s<a.length;s++)e.fillText(a[s],25,120+20*s);t.drawRoundedRect(e,25,250,280,110,8,!0,!1),e.fillText(t.title,25,175),e.drawImage(t.avatar,40,260,50,50),e.setFillStyle("black"),e.setFontSize(16),e.fillText(t.nickname,100,275),e.setFillStyle("gray"),e.setFontSize(12),e.fillText(t.where,100,300),e.moveTo(40,315),e.lineTo(280,317),e.ineWidth=1,e.strokeStyle="#f5f5f5",e.stroke(),e.setFontSize(16),e.fillText("坚持打卡天数",50,340),e.setFillStyle("black"),e.setFontSize(12);var r=t.date+"天";e.fillText(r,250,340),e.setFillStyle("white"),t.drawRoundedRect(e,25,400,280,55,8,!0,!1),e.drawImage("/img/index/logo.png",35,408,100,40),e.drawImage(t.code,240,408,40,40),e.draw(),t.setData({isCan:!0})}},save:function(){wx.canvasToTempFilePath({canvasId:"customCanvas",success:function(t){wx.authorize({scope:"scope.writePhotosAlbum",success:function(){wx.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){wx.showToast({title:"图片保存成功",mask:!0});var t=Date.parse(new Date)/1e3;String(t),String(Math.floor(50*Math.random()))}})}})}},this)},closeCan:function(t){this.setData({isCan:!1})},shares:function(){wx.navigateTo({url:"/pages/myPublished/myPublished?dy_id="+this.dy_id})},drawRoundedRect:function(t,e,a,i,n,s,r,o){t.save(),t.beginPath(),t.moveTo(e+s,a),t.arcTo(e+i,a,e+i,a+s,s),t.arcTo(e+i,a+n,e+i-s,a+n,s),t.arcTo(e,a+n,e,a+n-s,s),t.arcTo(e,a,e+s,a,s),r&&t.fill(),o&&t.stroke(),t.restore()}}};e.default=r}).call(this,a("6e42")["default"])},"3a04":function(t,e,a){"use strict";var i,n=function(){var t=this,e=t.$createElement;t._self._c},s=[];a.d(e,"b",function(){return n}),a.d(e,"c",function(){return s}),a.d(e,"a",function(){return i})},4381:function(t,e,a){"use strict";(function(t){a("f9cd"),a("921b");i(a("66fd"));var e=i(a("6e87"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},"6e87":function(t,e,a){"use strict";a.r(e);var i=a("3a04"),n=a("1d5d");for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a("f699");var r,o=a("f0c5"),d=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);e["default"]=d.exports},f699:function(t,e,a){"use strict";var i=a("07df"),n=a.n(i);n.a}},[["4381","common/runtime","common/vendor"]]]);