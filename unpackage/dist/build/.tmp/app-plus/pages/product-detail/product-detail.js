(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product-detail/product-detail"],{"0738":function(t,e,a){"use strict";a.r(e);var i=a("c016"),s=a.n(i);for(var u in i)"default"!==u&&function(t){a.d(e,t,function(){return i[t]})}(u);e["default"]=s.a},"23ec":function(t,e,a){"use strict";var i=a("a9a3"),s=a.n(i);s.a},"2d95":function(t,e,a){"use strict";a.r(e);var i=a("3618"),s=a("0738");for(var u in s)"default"!==u&&function(t){a.d(e,t,function(){return s[t]})}(u);a("23ec");var n,o=a("f0c5"),r=Object(o["a"])(s["default"],i["b"],i["c"],!1,null,"33bb8b85",null,!1,i["a"],n);e["default"]=r.exports},3618:function(t,e,a){"use strict";var i={"uni-countdown":()=>a.e("components/uni-countdown/uni-countdown").then(a.bind(null,"3f18"))},s=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){e.stopPropagation(),t.evaluateList.total})},u=[];a.d(e,"b",function(){return s}),a.d(e,"c",function(){return u}),a.d(e,"a",function(){return i})},a9a3:function(t,e,a){},c016:function(t,e,a){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a("60db");function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var n=a("ec2b"),o={data:function(){return{evaluateList:"",detail:{},html:{},icon:{},p_id:0,is_share:"",collect_p:!1,buyQuantity:1,sku_arr:[],sku_show:!1,valueStr:"",valueStrNum:"",type:"",goods_spec_id:"",main_image:"",userName:"",attrValueList:"",swiperImages:[],productDetail:{},assemble:null,teamlist:[{name:"与女无瓜",num:"1"},{name:"与女无瓜",num:"1"}],pid:""}},onLoad:function(e){t("log",e," at pages\\product-detail\\product-detail.vue:291"),this.banner=JSON.parse(decodeURIComponent(e.productDetail)),this.pid=this.banner.id,this.getEvaluateList()},onShareAppMessage:function(t){if("button"===t.from)var e=t.target.dataset.p_name;else e="开心书写";var a=this;return{title:e,path:"pages/onlinestore/productDetail/productDetail?is_share=1&p_id="+a.p_id,success:function(t){}}},onShow:function(){this.setData({sku_show:!1,valueStrNum:"",valueStr:""})},mounted:function(){var e=this;(0,s.ajax)({url:"goods/detail",data:{p_id:this.pid},method:"POST",success:function(a){if(t("log",a.data.data," at pages\\product-detail\\product-detail.vue:332"),a.data.data.coupon_price=a.data.data.spec?a.data.data.spec[0].goods_price:a.data.data.coupon_price,a.data.data.image=a.data.data.spec?a.data.data.spec[0].spec_image:a.data.data.image,e.detail=a.data.data,e.collect_p=a.data.data.if_collect,e.main_image=a.data.data.image,a.data.data.specData){var i=a.data.data.specData,s=i.spec_attr;i.spec_list;e.sku_arr=s}},error:function(){}}),(0,s.ajax)({url:"assemble/wait",method:"POST",data:{goods_id:this.pid},success:function(t){var a=t.data.data,i=(a.count,a.list);e.teamlist=i},error:function(){}})},methods:{assmbleDetail:function(){i.navigateTo({url:"../assemble/assemble",success:function(t){},fail:function(){},complete:function(){}})},getEvaluateList:function(){var t=this;(0,s.ajax)({url:"evaluate/getEvaluateList",data:{goods_id:this.pid},success:function(e){if(t.evaluateList=e.data.data,0!=e.data.data.total){var a=e.data.data.list[0].nickname,i="evaluateList.list[0].nickname";if(1==a.length)that.setData(u({},i,"*"));else if(2==a.length){var s=a.slice(0,1);that.setData(u({},i,s+"*"))}else{var n=a.slice(0,1),o=a.slice(a.length-1,a.length);3==a.length?that.setData(u({},i,n+"*"+o)):that.setData(u({},i,n+"**"+o))}}}}),n.ajax()},add:function(t){var e=this;(0,s.ajax)({url:"cart/add",data:{p_id:this.p_id,goods_num:this.buyQuantity,goods_sku_id:this.valueStrNum},success:function(t){i.showToast({title:t.data.msg}),e.detail.specData&&e.closeSku()}})},showSku:function(t){this.sku_arr.length>0?(this.sku_show=!0,this.type=t.currentTarget.dataset.type):1==t.currentTarget.dataset.type?this.buyNow():this.add()},closeSku:function(){var t=this;this.sku_show=!1;var e=t.detail.specData.spec_attr;e.forEach(function(t){t.spec_items.forEach(function(t){t.selected=!1})}),t.setData({"detail.specData.spec_attr":e,sku_arr:e,valueStr:"","detail.coupon_price":t.detail.spec[0].goods_price,"detail.image":t.detail.spec[0].spec_image?t.detail.spec[0].spec_image:t.detail.image})},toTop:function(t){var e=this;e.pageScrollTo({scrollTop:0,duration:0})},lookMore:function(){var t=this;i.navigateTo({url:"commentList/commentList?p_id="+t.p_id+"&collect_p="+t.collect_p})},distachAttrValue:function(t){for(var e=this.attrValueList,a=0;a<t.length;a++)for(var i=0;i<t[a].attrValueList.length;i++){var s=this.getAttrIndex(t[a].attrValueList[i].attrKey,e);s>=0?this.isValueExist(t[a].attrValueList[i].attrValue,e[s].attrValues)||e[s].attrValues.push(t[a].attrValueList[i].attrValue):e.push({attrKey:t[a].attrValueList[i].attrKey,attrValues:[t[a].attrValueList[i].attrValue]})}for(a=0;a<e.length;a++)for(i=0;i<e[a].attrValues.length;i++)e[a].attrValueStatus?e[a].attrValueStatus[i]=!0:(e[a].attrValueStatus=[],e[a].attrValueStatus[i]=!0);this.setData({attrValueList:e})},getAttrIndex:function(t,e){for(var a=0;a<e.length;a++)if(t==e[a].attrKey)break;return a<e.length?a:-1},isValueExist:function(t,e){for(var a=0;a<e.length;a++)if(e[a]==t)break;return a<e.length},submit:function(){for(var t=this,e=!1,a=0;a<this.detail.spec.length;a++)if(this.valueStrNum==this.detail.spec[a].spec_sku_id){this.goods_spec_id=this.detail.spec[a].goods_spec_id,e=!0;break}0!=e&&this.valueStr?1==t.type?t.buyNow():t.add():wx.showToast({title:"请选择完整的规格！",icon:"loading",duration:1e3})},collectP:function(e){var a=this,u=this;(0,s.ajax)({url:"goods/goodsCollect",data:{p_id:u.pid},success:function(e){t("log",e.data.data," at pages\\product-detail\\product-detail.vue:587"),i.showToast({title:e.msg,icon:"none",mask:!0}),a.collect_p=!u.collect_p}})},goindex:function(){getApp().globalData.infoModel()},buyNow:function(){var e=this;(0,s.ajax)({url:"index/getProfile",success:function(a){var s=e;if(i.getStorageSync("loginToken")){var u={type:1,ids:e.pid,now_buy:1,goods_num:e.buyQuantity,valueStrNum:e.valueStrNum,goods_spec_id:e.goods_spec_id};i.navigateTo({url:"sureOrder/sureOrder?sureOrder="+encodeURIComponent(JSON.stringify(u))}),t("log",e.detail.specData," at pages\\product-detail\\product-detail.vue:624"),s.detail.specData&&(s.closeSku(),t("log","beij"," at pages\\product-detail\\product-detail.vue:627"))}else t("log","登录状态失效"," at pages\\product-detail\\product-detail.vue:608"),i.navigateTo({url:"../login/login"})}})},addCount:function(t){this.buyQuantity=parseInt(this.buyQuantity)+1},minusCount:function(t){this.buyQuantity<=1||(this.buyQuantity=parseInt(this.buyQuantity)-1)},selectAttrValue:function(t){var e=this.sku_arr,a=t.currentTarget.dataset.index,i=t.currentTarget.dataset.key,s=t.currentTarget.dataset.value,u=t.currentTarget.dataset.sec_index;this.selectValue(e,a,i,s,u)},selectValue:function(e,a,i,s,u){for(var n=0;n<e[a].spec_items.length;n++)e[a].selectedValue="",e[a].spec_items[n].item_id==i?e[a].spec_items[n].selected=!e[a].spec_items[n].selected:e[a].spec_items[n].selected=!1;e[a].selectedValue=s,this.sku_arr=e;for(var o="",r="",l=0;l<e.length;l++)for(n=0;n<e[l].spec_items.length;n++)e[l].spec_items[n].selected&&(o+=e[l].selectedValue+",",r+=e[l].spec_items[n].item_id+"_");"_"==r.substr(r.length-1,r.length)&&(r=r.substr(0,r.length-1)),","==o.substr(o.length-1,o.length)&&(o=o.substr(0,o.length-1));var c=r.split("").reverse().join("");for(l=0;l<this.detail.spec.length;l++)r!=this.detail.spec[l].spec_sku_id&&c!=this.detail.spec[l].spec_sku_id||(this.detail.spec[l].spec_image?this.detail.image=this.detail.spec[l].spec_image:this.detail.image=this.main_image,this.detail.coupon_price=this.detail.spec[l].goods_price);this.valueStr=o,this.valueStrNum=r,t("log",this.valueStrNum,"ggggggggggg"," at pages\\product-detail\\product-detail.vue:707")}}};e.default=o}).call(this,a("0de9")["default"],a("6e42")["default"])},f9d5:function(t,e,a){"use strict";(function(t){a("f9cd"),a("921b");i(a("66fd"));var e=i(a("2d95"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])}},[["f9d5","common/runtime","common/vendor"]]]);