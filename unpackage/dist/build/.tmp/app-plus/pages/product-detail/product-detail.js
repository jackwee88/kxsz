(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product-detail/product-detail"],{"0738":function(t,e,a){"use strict";a.r(e);var s=a("c016"),i=a.n(s);for(var u in s)"default"!==u&&function(t){a.d(e,t,function(){return s[t]})}(u);e["default"]=i.a},"16ee":function(t,e,a){"use strict";a.r(e);var s=a("df89"),i=a("e47c");for(var u in i)"default"!==u&&function(t){a.d(e,t,function(){return i[t]})}(u);a("d892");var n,r=a("f0c5"),o=Object(r["a"])(i["default"],s["b"],s["c"],!1,null,"7537d542",null,!1,s["a"],n);e["default"]=o.exports},2418:function(t,e,a){},"296b":function(t,e,a){"use strict";var s=a("52d2"),i=a.n(s);i.a},"2d95":function(t,e,a){"use strict";a.r(e);var s=a("537b"),i=a("0738");for(var u in i)"default"!==u&&function(t){a.d(e,t,function(){return i[t]})}(u);a("296b");var n,r=a("f0c5"),o=Object(r["a"])(i["default"],s["b"],s["c"],!1,null,"01b316b4",null,!1,s["a"],n);e["default"]=o.exports},4243:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{}}};e.default=s},"52d2":function(t,e,a){},"537b":function(t,e,a){"use strict";var s={"uni-countdown":()=>a.e("components/uni-countdown/uni-countdown").then(a.bind(null,"3f18"))},i=function(){var t=this,e=t.$createElement;t._self._c},u=[];a.d(e,"b",function(){return i}),a.d(e,"c",function(){return u}),a.d(e,"a",function(){return s})},c016:function(t,e,a){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("60db");u(a("16ee"));function u(t){return t&&t.__esModule?t:{default:t}}function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=a("ec2b"),o={data:function(){return{evaluateList:{total:56,count:6,list:[{avatar:"",nickname:"",content:""}]},visible:!1,detail:{},html:{},icon:{},p_id:0,is_share:"",collect_p:!1,buyQuantity:1,sku_arr:[],sku_show:!1,valueStr:"",valueStrNum:"",type:"",goods_spec_id:"",main_image:"",userName:"",attrValueList:"",swiperImages:[],productDetail:{},hour:0,minute:0,second:0,assemble:null,teamlist:[{name:"与女无瓜",num:"1"},{name:"与女无瓜",num:"1"}],banner:"",pid:""}},onLoad:function(t){this.pid=t.gd_id,this.getData(),this.getEvaluateList()},onShareAppMessage:function(t){if("button"===t.from)var e=t.target.dataset.p_name;else e="开心书写";var a=this;return{title:e,path:"pages/onlinestore/productDetail/productDetail?is_share=1&p_id="+a.p_id,success:function(t){}}},onShow:function(){this.setData({sku_show:!1,valueStrNum:"",valueStr:""})},mounted:function(){},methods:{setData:function(t){for(var e in t){var a=t[e];this[e]=a}},assmebleOrder:function(e){t.showToast({title:"请先选择收货地址"});var a={ar_id:338,goods_sku_id:this.valueStrNum,goods_spec_id:this.goods_spec_id,p_id:this.pid,quantity:1,type:2,assemble_order_id:e.currentTarget.dataset.orderid};(0,i.ajax)({url:"goods/assembleOrder",data:a,success:function(t){}})},assmbleDetail:function(){this.visible=!0},getData:function(){var t=this;(0,i.ajax)({url:"goods/detail",data:{p_id:this.pid},method:"POST",success:function(e){if(e.data.data.coupon_price=e.data.data.spec?e.data.data.spec[0].goods_price:e.data.data.coupon_price,e.data.data.image=e.data.data.spec?e.data.data.spec[0].spec_image:e.data.data.image,t.detail=e.data.data,t.collect_p=e.data.data.if_collect,t.main_image=e.data.data.image,e.data.data.specData){var a=e.data.data.specData,s=a.spec_attr;a.spec_list;t.sku_arr=s}2==e.data.data.sale_status&&t.getflashtime(),t.goods_spec_id=e.data.data.spec[0].goods_spec_id,t.valueStrNum=e.data.data.spec[0].spec_sku_id,""==!e.data.data.assemble&&t.getAssemble()},error:function(){}})},getAssemble:function(){var t=this;(0,i.ajax)({url:"assemble/wait",method:"POST",data:{goods_id:this.pid},success:function(e){var a=e.data.data,s=(a.count,a.list);t.teamlist=s},error:function(){}})},getflashtime:function(){var t=this;(0,i.ajax)({url:"assemble/flashSale",data:{},success:function(e){var a=e.data.data,i=(a.count,a.list);t.flashSale=i[0].goods;var u=(new Date).getTime()/1e3;if(u>i[0].endtime)s("log","秒杀结束"," at pages\\product-detail\\product-detail.vue:473");else if(u<i[0].createTime)s("log","秒杀未开始"," at pages\\product-detail\\product-detail.vue:475");else{var n=i[0].endtime-u;t.timeChange(n)}}})},timeChange:function(t){var e=parseInt(t);if(e>60){var a=parseInt(e/60);if(e=parseInt(e%60),a>60){var s=parseInt(a/60);a=parseInt(a%60),this.hour=s}}var i=parseInt(e);if(this.second=i,a>0){var u=parseInt(a);this.minute=u}if(s>0){s=parseInt(s);this.hour=s}return i},getEvaluateList:function(){var t=this,e=this;(0,i.ajax)({url:"evaluate/getEvaluateList",data:{goods_id:this.pid},success:function(a){if(t.evaluateList=a.data.data,0!=a.data.data.total){var s=a.data.data.list[0].nickname,i="evaluateList.list[0].nickname";if(1==s.length)e.setData(n({},i,"*"));else if(2==s.length){var u=s.slice(0,1);e.setData(n({},i,u+"*"))}else{var r=s.slice(0,1),o=s.slice(s.length-1,s.length);3==s.length?e.setData(n({},i,r+"*"+o)):e.setData(n({},i,r+"**"+o))}}}}),r.ajax()},add:function(e){var a=this;(0,i.ajax)({url:"cart/add",data:{p_id:this.pid,goods_num:this.buyQuantity,goods_sku_id:this.valueStrNum},success:function(e){t.showToast({title:e.data.msg}),a.detail.specData&&a.closeSku()}})},showSku:function(t){this.sku_arr.length>0?(this.sku_show=!0,this.type=t.currentTarget.dataset.type):1==t.currentTarget.dataset.type?this.buyNow():this.add()},closeSku:function(){var t=this;this.sku_show=!1;var e=t.detail.specData.spec_attr;e.forEach(function(t){t.spec_items.forEach(function(t){t.selected=!1})}),t.setData({"detail.specData.spec_attr":e,sku_arr:e,valueStr:"","detail.coupon_price":t.detail.spec[0].goods_price,"detail.image":t.detail.spec[0].spec_image?t.detail.spec[0].spec_image:t.detail.image})},toTop:function(t){var e=this;e.pageScrollTo({scrollTop:0,duration:0})},lookMore:function(){if(0!=this.evaluateList.total){var e=this;t.navigateTo({url:"commentList/commentList?p_id="+e.pid+"&collect_p="+e.collect_p})}},distachAttrValue:function(t){for(var e=this.attrValueList,a=0;a<t.length;a++)for(var s=0;s<t[a].attrValueList.length;s++){var i=this.getAttrIndex(t[a].attrValueList[s].attrKey,e);i>=0?this.isValueExist(t[a].attrValueList[s].attrValue,e[i].attrValues)||e[i].attrValues.push(t[a].attrValueList[s].attrValue):e.push({attrKey:t[a].attrValueList[s].attrKey,attrValues:[t[a].attrValueList[s].attrValue]})}for(a=0;a<e.length;a++)for(s=0;s<e[a].attrValues.length;s++)e[a].attrValueStatus?e[a].attrValueStatus[s]=!0:(e[a].attrValueStatus=[],e[a].attrValueStatus[s]=!0);this.setData({attrValueList:e})},getAttrIndex:function(t,e){for(var a=0;a<e.length;a++)if(t==e[a].attrKey)break;return a<e.length?a:-1},isValueExist:function(t,e){for(var a=0;a<e.length;a++)if(e[a]==t)break;return a<e.length},submit:function(){for(var t=this,e=!1,a=0;a<this.detail.spec.length;a++)if(this.valueStrNum==this.detail.spec[a].spec_sku_id){this.goods_spec_id=this.detail.spec[a].goods_spec_id,s("log",this.goods_spec_id," at pages\\product-detail\\product-detail.vue:693"),e=!0;break}0!=e&&this.valueStr?1==t.type?t.buyNow():t.add():wx.showToast({title:"请选择完整的规格！",icon:"loading",duration:1e3})},collectP:function(e){var a=this,u=this;(0,i.ajax)({url:"goods/goodsCollect",data:{p_id:this.pid},success:function(e){s("log",e.data.data," at pages\\product-detail\\product-detail.vue:730"),t.showToast({title:e.data.msg,icon:"none",mask:!0}),a.collect_p=!u.collect_p}})},goindex:function(){getApp().globalData.infoModel()},buyNow:function(){var e=this;(0,i.ajax)({url:"index/getProfile",success:function(a){var i=e;if(t.getStorageSync("loginToken")){var u={type:1,ids:e.pid,now_buy:1,goods_num:e.buyQuantity,goods_sku_id:e.valueStrNum,goods_spec_id:e.goods_spec_id};t.navigateTo({url:"sureOrder/sureOrder?sureOrder="+encodeURIComponent(JSON.stringify(u))}),i.detail.specData&&(i.closeSku(),s("log","beij"," at pages\\product-detail\\product-detail.vue:769"))}else s("log","登录状态失效"," at pages\\product-detail\\product-detail.vue:751"),t.navigateTo({url:"../login/login"})}})},addCount:function(t){this.buyQuantity=parseInt(this.buyQuantity)+1},minusCount:function(t){this.buyQuantity<=1||(this.buyQuantity=parseInt(this.buyQuantity)-1)},selectAttrValue:function(t){var e=this.sku_arr,a=t.currentTarget.dataset.index,s=t.currentTarget.dataset.key,i=t.currentTarget.dataset.value,u=t.currentTarget.dataset.sec_index;this.selectValue(e,a,s,i,u)},selectValue:function(t,e,a,i,u){for(var n=0;n<t[e].spec_items.length;n++)t[e].selectedValue="",t[e].spec_items[n].item_id==a?t[e].spec_items[n].selected=!t[e].spec_items[n].selected:t[e].spec_items[n].selected=!1;t[e].selectedValue=i,this.sku_arr=t,s("log",this.sku_arr," at pages\\product-detail\\product-detail.vue:815");for(var r="",o="",d=0;d<t.length;d++)for(n=0;n<t[d].spec_items.length;n++)t[d].spec_items[n].selected&&(r+=t[d].selectedValue+",",o+=t[d].spec_items[n].item_id+"_");"_"==o.substr(o.length-1,o.length)&&(o=o.substr(0,o.length-1)),","==r.substr(r.length-1,r.length)&&(r=r.substr(0,r.length-1));var c=o.split("").reverse().join("");for(d=0;d<this.detail.spec.length;d++)o!=this.detail.spec[d].spec_sku_id&&c!=this.detail.spec[d].spec_sku_id||(this.detail.spec[d].spec_image?this.detail.image=this.detail.spec[d].spec_image:this.detail.image=this.main_image,this.detail.coupon_price=this.detail.spec[d].goods_price);this.valueStr=r,this.valueStrNum=o,s("log",this.valueStrNum,"ggggggggggg"," at pages\\product-detail\\product-detail.vue:850")}}};e.default=o}).call(this,a("6e42")["default"],a("0de9")["default"])},d892:function(t,e,a){"use strict";var s=a("2418"),i=a.n(s);i.a},df89:function(t,e,a){"use strict";var s,i=function(){var t=this,e=t.$createElement;t._self._c},u=[];a.d(e,"b",function(){return i}),a.d(e,"c",function(){return u}),a.d(e,"a",function(){return s})},e47c:function(t,e,a){"use strict";a.r(e);var s=a("4243"),i=a.n(s);for(var u in s)"default"!==u&&function(t){a.d(e,t,function(){return s[t]})}(u);e["default"]=i.a},f9d5:function(t,e,a){"use strict";(function(t){a("f9cd"),a("921b");s(a("66fd"));var e=s(a("2d95"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])}},[["f9d5","common/runtime","common/vendor"]]]);