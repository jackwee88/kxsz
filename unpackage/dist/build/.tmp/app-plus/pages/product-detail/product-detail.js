(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product-detail/product-detail"],{"0133":function(t,e,a){},"036d":function(t,e,a){"use strict";var i=a("0133"),s=a.n(i);s.a},"0738":function(t,e,a){"use strict";a.r(e);var i=a("c016"),s=a.n(i);for(var u in i)"default"!==u&&function(t){a.d(e,t,function(){return i[t]})}(u);e["default"]=s.a},"16ee":function(t,e,a){"use strict";a.r(e);var i=a("df89"),s=a("e47c");for(var u in s)"default"!==u&&function(t){a.d(e,t,function(){return s[t]})}(u);a("d892");var n,r=a("f0c5"),o=Object(r["a"])(s["default"],i["b"],i["c"],!1,null,"7537d542",null,!1,i["a"],n);e["default"]=o.exports},2191:function(t,e,a){"use strict";var i={"uni-countdown":()=>a.e("components/uni-countdown/uni-countdown").then(a.bind(null,"3f18"))},s=function(){var t=this,e=t.$createElement;t._self._c},u=[];a.d(e,"b",function(){return s}),a.d(e,"c",function(){return u}),a.d(e,"a",function(){return i})},2418:function(t,e,a){},"2d95":function(t,e,a){"use strict";a.r(e);var i=a("2191"),s=a("0738");for(var u in s)"default"!==u&&function(t){a.d(e,t,function(){return s[t]})}(u);a("036d");var n,r=a("f0c5"),o=Object(r["a"])(s["default"],i["b"],i["c"],!1,null,"22ac4f66",null,!1,i["a"],n);e["default"]=o.exports},4243:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{}}};e.default=i},c016:function(t,e,a){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a("60db");u(a("16ee"));function u(t){return t&&t.__esModule?t:{default:t}}function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=a("ec2b"),o={data:function(){return{evaluateList:{total:56,count:6,list:[{avatar:"",nickname:"",content:""}]},visible:!1,detail:{},html:{},icon:{},p_id:0,is_share:"",collect_p:!1,buyQuantity:1,sku_arr:[],sku_show:!1,valueStr:"",valueStrNum:"",type:"",goods_spec_id:"",main_image:"",userName:"",attrValueList:"",swiperImages:[],productDetail:{},hour:0,minute:0,second:0,assemble:null,teamlist:[{name:"与女无瓜",num:"1"},{name:"与女无瓜",num:"1"}],banner:"",pid:""}},onLoad:function(t){this.pid=t.gd_id,this.getData(),this.getEvaluateList()},onShareAppMessage:function(t){if("button"===t.from)var e=t.target.dataset.p_name;else e="开心书写";var a=this;return{title:e,path:"pages/onlinestore/productDetail/productDetail?is_share=1&p_id="+a.p_id,success:function(t){}}},onShow:function(){this.setData({sku_show:!1,valueStrNum:"",valueStr:""})},mounted:function(){},methods:{setData:function(t){for(var e in t){var a=t[e];this[e]=a}},assmebleOrder:function(){},assmbleDetail:function(){t.navigateTo({url:"../assemble/assemble",success:function(t){},fail:function(){},complete:function(){}})},getData:function(){var t=this;(0,s.ajax)({url:"goods/detail",data:{p_id:this.pid},method:"POST",success:function(e){if(i("log",e.data.data," at pages\\product-detail\\product-detail.vue:411"),i("log",e.data.data.spec[0].goods_spec_id," at pages\\product-detail\\product-detail.vue:412"),e.data.data.coupon_price=e.data.data.spec?e.data.data.spec[0].goods_price:e.data.data.coupon_price,e.data.data.image=e.data.data.spec?e.data.data.spec[0].spec_image:e.data.data.image,t.detail=e.data.data,t.collect_p=e.data.data.if_collect,t.main_image=e.data.data.image,e.data.data.specData){var a=e.data.data.specData,s=a.spec_attr;a.spec_list;t.sku_arr=s}2==e.data.data.sale_status&&t.getflashtime(),t.goods_spec_id=e.data.data.spec[0].goods_spec_id,t.valueStrNum=e.data.data.spec[0].spec_sku_id,""==!e.data.data.assemble&&t.getAssemble()},error:function(){}})},getAssemble:function(){var t=this;(0,s.ajax)({url:"assemble/wait",method:"POST",data:{goods_id:this.pid},success:function(e){var a=e.data.data,i=(a.count,a.list);t.teamlist=i},error:function(){}})},getflashtime:function(){var t=this;(0,s.ajax)({url:"assemble/flashSale",data:{},success:function(e){var a=e.data.data,s=(a.count,a.list);t.flashSale=s.goods,i("log",t.flashSale.p_id," at pages\\product-detail\\product-detail.vue:455");var u=(new Date).getTime()/1e3;if(u>s.endtime)i("log","秒杀结束"," at pages\\product-detail\\product-detail.vue:459");else if(u<s.createTime)i("log","秒杀未开始"," at pages\\product-detail\\product-detail.vue:461");else{var n=s.endtime-u;t.timeChange(n)}}})},timeChange:function(t){var e=parseInt(t);if(e>60){var a=parseInt(e/60);if(e=parseInt(e%60),a>60){var i=parseInt(a/60);a=parseInt(a%60),this.hour=i}}var s=parseInt(e);if(this.second=s,a>0){var u=parseInt(a);this.minute=u}if(i>0){i=parseInt(i);this.hour=i}return s},getEvaluateList:function(){var t=this,e=this;(0,s.ajax)({url:"evaluate/getEvaluateList",data:{goods_id:this.pid},success:function(a){if(t.evaluateList=a.data.data,0!=a.data.data.total){var i=a.data.data.list[0].nickname,s="evaluateList.list[0].nickname";if(1==i.length)e.setData(n({},s,"*"));else if(2==i.length){var u=i.slice(0,1);e.setData(n({},s,u+"*"))}else{var r=i.slice(0,1),o=i.slice(i.length-1,i.length);3==i.length?e.setData(n({},s,r+"*"+o)):e.setData(n({},s,r+"**"+o))}}}}),r.ajax()},add:function(e){var a=this;(0,s.ajax)({url:"cart/add",data:{p_id:this.pid,goods_num:this.buyQuantity,goods_sku_id:this.valueStrNum},success:function(e){t.showToast({title:e.data.msg}),a.detail.specData&&a.closeSku()}})},showSku:function(t){this.sku_arr.length>0?(this.sku_show=!0,this.type=t.currentTarget.dataset.type):1==t.currentTarget.dataset.type?this.buyNow():this.add()},closeSku:function(){var t=this;this.sku_show=!1;var e=t.detail.specData.spec_attr;e.forEach(function(t){t.spec_items.forEach(function(t){t.selected=!1})}),t.setData({"detail.specData.spec_attr":e,sku_arr:e,valueStr:"","detail.coupon_price":t.detail.spec[0].goods_price,"detail.image":t.detail.spec[0].spec_image?t.detail.spec[0].spec_image:t.detail.image})},toTop:function(t){var e=this;e.pageScrollTo({scrollTop:0,duration:0})},lookMore:function(){if(0!=this.evaluateList.total){var e=this;t.navigateTo({url:"commentList/commentList?p_id="+e.pid+"&collect_p="+e.collect_p})}},distachAttrValue:function(t){for(var e=this.attrValueList,a=0;a<t.length;a++)for(var i=0;i<t[a].attrValueList.length;i++){var s=this.getAttrIndex(t[a].attrValueList[i].attrKey,e);s>=0?this.isValueExist(t[a].attrValueList[i].attrValue,e[s].attrValues)||e[s].attrValues.push(t[a].attrValueList[i].attrValue):e.push({attrKey:t[a].attrValueList[i].attrKey,attrValues:[t[a].attrValueList[i].attrValue]})}for(a=0;a<e.length;a++)for(i=0;i<e[a].attrValues.length;i++)e[a].attrValueStatus?e[a].attrValueStatus[i]=!0:(e[a].attrValueStatus=[],e[a].attrValueStatus[i]=!0);this.setData({attrValueList:e})},getAttrIndex:function(t,e){for(var a=0;a<e.length;a++)if(t==e[a].attrKey)break;return a<e.length?a:-1},isValueExist:function(t,e){for(var a=0;a<e.length;a++)if(e[a]==t)break;return a<e.length},submit:function(){for(var t=this,e=!1,a=0;a<this.detail.spec.length;a++)if(this.valueStrNum==this.detail.spec[a].spec_sku_id){this.goods_spec_id=this.detail.spec[a].goods_spec_id,i("log",this.goods_spec_id," at pages\\product-detail\\product-detail.vue:679"),e=!0;break}0!=e&&this.valueStr?1==t.type?t.buyNow():t.add():wx.showToast({title:"请选择完整的规格！",icon:"loading",duration:1e3})},collectP:function(e){var a=this,u=this;(0,s.ajax)({url:"goods/goodsCollect",data:{p_id:this.pid},success:function(e){i("log",e.data.data," at pages\\product-detail\\product-detail.vue:716"),t.showToast({title:e.data.msg,icon:"none",mask:!0}),a.collect_p=!u.collect_p}})},goindex:function(){getApp().globalData.infoModel()},buyNow:function(){var e=this;(0,s.ajax)({url:"index/getProfile",success:function(a){var s=e;if(t.getStorageSync("loginToken")){var u={type:1,ids:e.pid,now_buy:1,goods_num:e.buyQuantity,goods_sku_id:e.valueStrNum,goods_spec_id:e.goods_spec_id};t.navigateTo({url:"sureOrder/sureOrder?sureOrder="+encodeURIComponent(JSON.stringify(u))}),i("log",e.detail.specData," at pages\\product-detail\\product-detail.vue:753"),s.detail.specData&&(s.closeSku(),i("log","beij"," at pages\\product-detail\\product-detail.vue:756"))}else i("log","登录状态失效"," at pages\\product-detail\\product-detail.vue:737"),t.navigateTo({url:"../login/login"})}})},addCount:function(t){this.buyQuantity=parseInt(this.buyQuantity)+1},minusCount:function(t){this.buyQuantity<=1||(this.buyQuantity=parseInt(this.buyQuantity)-1)},selectAttrValue:function(t){var e=this.sku_arr,a=t.currentTarget.dataset.index,i=t.currentTarget.dataset.key,s=t.currentTarget.dataset.value,u=t.currentTarget.dataset.sec_index;this.selectValue(e,a,i,s,u)},selectValue:function(t,e,a,s,u){for(var n=0;n<t[e].spec_items.length;n++)t[e].selectedValue="",t[e].spec_items[n].item_id==a?t[e].spec_items[n].selected=!t[e].spec_items[n].selected:t[e].spec_items[n].selected=!1;t[e].selectedValue=s,this.sku_arr=t,i("log",this.sku_arr," at pages\\product-detail\\product-detail.vue:802");for(var r="",o="",d=0;d<t.length;d++)for(n=0;n<t[d].spec_items.length;n++)t[d].spec_items[n].selected&&(r+=t[d].selectedValue+",",o+=t[d].spec_items[n].item_id+"_");"_"==o.substr(o.length-1,o.length)&&(o=o.substr(0,o.length-1)),","==r.substr(r.length-1,r.length)&&(r=r.substr(0,r.length-1));var c=o.split("").reverse().join("");for(d=0;d<this.detail.spec.length;d++)o!=this.detail.spec[d].spec_sku_id&&c!=this.detail.spec[d].spec_sku_id||(this.detail.spec[d].spec_image?this.detail.image=this.detail.spec[d].spec_image:this.detail.image=this.main_image,this.detail.coupon_price=this.detail.spec[d].goods_price);this.valueStr=r,this.valueStrNum=o,i("log",this.valueStrNum,"ggggggggggg"," at pages\\product-detail\\product-detail.vue:837")}}};e.default=o}).call(this,a("6e42")["default"],a("0de9")["default"])},d892:function(t,e,a){"use strict";var i=a("2418"),s=a.n(i);s.a},df89:function(t,e,a){"use strict";var i,s=function(){var t=this,e=t.$createElement;t._self._c},u=[];a.d(e,"b",function(){return s}),a.d(e,"c",function(){return u}),a.d(e,"a",function(){return i})},e47c:function(t,e,a){"use strict";a.r(e);var i=a("4243"),s=a.n(i);for(var u in i)"default"!==u&&function(t){a.d(e,t,function(){return i[t]})}(u);e["default"]=s.a},f9d5:function(t,e,a){"use strict";(function(t){a("f9cd"),a("921b");i(a("66fd"));var e=i(a("2d95"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])}},[["f9d5","common/runtime","common/vendor"]]]);