(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shoppingcart/sureorder/sureorder"],{"009d":function(t,e,i){"use strict";var s,a=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"b",function(){return a}),i.d(e,"c",function(){return o}),i.d(e,"a",function(){return s})},"48d9":function(t,e,i){},5285:function(t,e,i){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i("ec2b"),o={data:function(){return{index:0,invoiceArr:{},is_fp:"不开发票",dzxy:"",is_dzxy:"",ewm:"",is_ewm:!1,moneys:"",discount:"",integral:"109",storeimg:"https://kxsx-front-pic.oss-cn-beijing.aliyuncs.com/test/chanpintu.png",title:"多功能尺子教学全套课程",guankan:"永久观看",selected:!0,selected_integral:!1,type:1,ids:"",ct_id:"",p_id:"",goods:[],address:{},total:0,totals:"",flag_y:!1,flag_n:!1,prv_money:0,transport_total:0,selected_num:0,num:0,buy_num:1,now_buy:"",selected_other:!1,is_save:!1,order_id:"",explain:"",selected_explain:!0,price:"",goods_sku_id:"",goods_num:"",goods_spec_id:"",remarks:""}},components:{},props:{},onLoad:function(e){t.setStorageSync("a",[]),1==e.now_buy&&(this.now_buy=1,this.goods_sku_id=e.goods_sku_id,this.goods_num=e.goods_num,this.buy_num=e.goods_num,this.goods_spec_id=e.goods_spec_id);var i=this;this.dzxyFun(),!e.type||1!=e.type&&2!=e.type||(i.type=e.type),e.ids?i.ids=e.ids:t.navigateBack({}),1==i.type?(i.p_id=i.ids,i.ct_id=""):2==i.type&&(i.p_id="",i.ct_id=i.ids);var s={ct_id:i.ct_id,p_id:i.p_id,goods_sku_id:i.goods_sku_id,goods_num:i.goods_num,goods_spec_id:i.goods_spec_id};a.ajax({url:"goods/settlement",data:s,success:function(e){0==e.data.send_status&&t.showToast({title:"当前地址不在配送范围哦 ~",icon:"none"}),i.goods=e.data.goods,i.address=e.data.address,i.total=e.data.total,i.totals=e.data.total.toFixed(2),i.integral=e.data.score,i.transport_total=e.data.transport_total,i.price=e.data.total}})},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{linkTo:function(){t.navigateTo({url:"../shaddress/shaddress?quantity="+this.buy_num+"&ct_id="+this.ct_id+"&p_id="+this.goods[0].p_id+"&score="+this.selected_integral+"&cp_id="+this.discount+"&goods_sku_id="+this.goods_sku_id})},changeData:function(t){that.address=t},pay:function(){var e=this;if(this.selected_explain){if(1==this.now_buy){s("log",this.remarks," at pages\\shoppingcart\\sureorder\\sureorder.vue:478");var i={ct_id:this.ct_id,p_id:this.goods[0].p_id,ar_id:this.address.ar_id,score:this.selected_integral,cp_id:this.discount,quantity:this.buy_num,invoiceArr:this.invoiceArr,account:this.invoiceArr.content,account_type:this.invoiceArr.acc_type,goods_sku_id:e.goods_sku_id,mark:this.remarks}}else{s("log",this.remarks," at pages\\shoppingcart\\sureorder\\sureorder.vue:494");i={ct_id:this.ct_id,p_id:this.goods[0].p_id,ar_id:this.address.ar_id,score:this.selected_integral,cp_id:this.discount,invoiceArr:this.invoiceArr,account:this.invoiceArr.content,account_type:this.invoiceArr.acc_type,goods_sku_id:e.goods_sku_id,mark:this.remarks}}1==this.selected_other?a.ajax({url:"goods/downOrder",data:i,success:function(i){e.order_id=i.data.order_id,a.ajax({url:"goods/repay_other",data:{order_id:i.data.order_id},success:function(i){e.ewm=i.data.code,e.is_ewm=!0;var s=t.getFileSystemManager();s.writeFile({filePath:t.env.USER_DATA_PATH+"/test.png",data:e.ewm.slice(22),encoding:"base64",success:function(i){t.saveImageToPhotosAlbum({filePath:t.env.USER_DATA_PATH+"/test.png",success:function(t){e.is_save=!0},fail:function(t){}})},fail:function(t){}})}})}}):a.ajax({url:"goods/downOrder",data:i,success:function(e){2!=e.status?a.ajax({url:"paygoods/pay",data:{order_id:e.data.order_id},success:function(i){t.requestPayment({timeStamp:String(i.data.timeStamp),nonceStr:i.data.nonceStr,package:i.data.package,signType:i.data.signType,paySign:i.data.paySign,success:function(i){t.redirectTo({url:"/pages/onlinestore/orderdetails/orderdetails?order_id="+e.data.order_id})},fail:function(){t.redirectTo({url:"/pages/onlinestore/orderdetails/orderdetails?order_id="+e.data.order_id})},complete:function(){}})}}):t.showToast({title:e.msg,icon:"none"})}})}else t.showToast({title:"请先同意电子协议",icon:"none"})},linkToMy:function(e){var i=e.currentTarget.dataset.money;t.navigateTo({url:"/pages/my/mydiscount/mydiscount?way=1&money="+i+"&prv_money="+this.prv_money+"&ct_id="+this.ct_id+"&p_id="+this.goods[0].p_id+"&ar_id="+this.address.ar_id+"&score="+this.selected_integral+"&quantity="+this.buy_num+"&cp_id="+this.discount+"&price="+this.price+"&goods_sku_id="+this.goods_sku_id})},selectList:function(e){if(!this.address)return t.showToast({title:"请先选择收货地址",icon:"none"}),!1;var i=this.integral/100,s=parseFloat(i.toFixed(2));if(this.selected_integral=!this.selected_integral,1==this.selected_integral){if(0==this.flag_y){this.flag_n=!1;var a=(this.totals-s).toFixed(2);a<=0&&(a=.01),this.jf()}}else{if(0==this.flag_n){a=(parseFloat(this.totals)+parseFloat(s)).toFixed(2);this.jf()}this.flag_y=!1}},addCount:function(t){var e=t.currentTarget.dataset.index,i=(t.currentTarget.dataset.ct_id,t.currentTarget.dataset.goods_price),s=this.goods;if(parseFloat(s[e].quantity)+1<=1)return!1;s[e].quantity=parseFloat(s[e].quantity)+1;var a=parseFloat(i*s[e].quantity)+parseFloat(this.transport_total);this.goods=s,this.totals=a.toFixed(2),this.buy_num=s[e].quantity,this.jf()},minusCount:function(t){var e=this,i=t.currentTarget.dataset.index,s=(t.currentTarget.dataset.ct_id,t.currentTarget.dataset.coupon_price),a=this.goods;if(a[i].quantity<=1)return!1;a[i].quantity=parseFloat(a[i].quantity)-1;var o=parseFloat(s*a[i].quantity)+parseFloat(e.transport_total);this.goods=a,this.totals=o.toFixed(2),this.buy_num=a[i].quantity,this.jf()},changeNum:function(t){var e=this,i=t.currentTarget.dataset.index,s=t.currentTarget.dataset.coupon_price,a=e.goods;a[i].quantity=t.detail.value,this.goods=a,buy_num=t.detail.value;var o=parseFloat(s*t.detail.value)+parseFloat(e.transport_total);this.totals=o.toFixed(2),this.jf()},jf:function(){this.address||(this.address=""),s("log",this.buy_num," at pages\\shoppingcart\\sureorder\\sureorder.vue:696");var t={ct_id:this.ct_id,p_id:this.goods[0].p_id,ar_id:this.address.ar_id,score:this.selected_integral,cp_id:this.discount,quantity:this.buy_num,goods_sku_id:this.goods_sku_id},e=this;a.ajax({url:"goods/OrderMoney",data:t,success:function(t){e.integral=t.data.use_integral,e.totals=t.data.amount.toFixed(2),e.price=t.data.prices,e.transport_total=t.data.transport}})},selectListOther:function(t){this.selected_other=!this.selected_other},closeEwm:function(){this.is_ewm=!1,t.redirectTo({url:"/pages/onlinestore/orderdetails/orderdetails?order_id="+this.order_id})},selectExplain:function(t){this.selected_explain=!this.selected_explain},explainFun:function(){this.is_dzxy=!0},hideExplain:function(){this.is_dzxy=!1},dzxyFun:function(){var t=this;a.ajax({url:"index/getSystemDesc",data:{type:5},success:function(e){t.dzxy=e.data}})},toDzxy:function(){t.navigateTo({url:"/pages/dzxy/dzxy"})},invoice:function(){t.navigateTo({url:"/pages/invoice/invoice"})},toTop:function(t){var e=this;e.pageScrollTo({scrollTop:0,duration:0})},bindRemarksAreaBlur:function(t){this.remarks=t.detail.value}}};e.default=o}).call(this,i("6e42")["default"],i("0de9")["default"])},"5d4e":function(t,e,i){"use strict";var s=i("48d9"),a=i.n(s);a.a},6255:function(t,e,i){"use strict";i.r(e);var s=i("5285"),a=i.n(s);for(var o in s)"default"!==o&&function(t){i.d(e,t,function(){return s[t]})}(o);e["default"]=a.a},c835:function(t,e,i){"use strict";i.r(e);var s=i("009d"),a=i("6255");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("5d4e");var n,d=i("f0c5"),r=Object(d["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],n);e["default"]=r.exports},ccf3:function(t,e,i){"use strict";(function(t){i("f9cd"),i("921b");s(i("66fd"));var e=s(i("c835"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])}},[["ccf3","common/runtime","common/vendor"]]]);